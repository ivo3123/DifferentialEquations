# Домашно

Домашното има 2 компонента - аналитично решение на диференциално уравнение от първи ред и код на MATLAB

## Аналитично решение

Има дадено диференциално уравнение и трябва да се реши аналитично. Различните видове ОДУ от първи ред може да видите в папката за първо контролно и в записките от семинари.

Начини за предаване:

* да се напише на хартия и да се предаде pdf от снимки (по възможност сканирани)
* да се напипе tex документ (например LaTeX) и да произведе pdf
* да се напише на графичен таблен или сродно и да се предаде като pdf
* да се напише на word/google doc и да се използва математическата нотация от там (силно непрепоръчително)

## MATLAB част

Има два типа задача:

* символно решение
* числено решение

Нека разгледаме пример за следната задача на Коши:

$$
\begin{cases}
y' = \dfrac{2}{y}(x+1)^2\\
y(0) = 2
\end{cases}
$$

Искаме да се намери силволно решение и числено приближение в интервала $x\in [0, 5]$ и да се начертае графиката на решението в същия интервал.

### Символно решение

```matlab
syms x y(x)

ode = diff(y, x) == (2 / y) * (x+1)^2

initial_condition = y(0) == 2

symbolic_solution = dsolve(ode, initial_condition)

x_axis = 0:0.25:5;  % равноотдалечени възли от 0 до 5 през 0.25

plot(x_axis, double(subs(symbolic_solution, x, x_axis)))  % ако използвате Octave
% или
% plot(x_axis, eval(symbolic_solution))  % ако използвате MATLAB
```

### Числено решение

```matlab
f = @(x, y) (2 / y) * (x+1)^2

y_0 = 2;

[nodes, y_values] = ode45(f, [0, 5], y_0);

plot(nodes, y_values)
```

или

```matlab
function dydx = f(x, y)
    dydx = (2 / y) * (x+1)^2;
end

y_0 = 2;

[nodes, y_values] = ode45(@f, [0, 5], y_0);

plot(nodes, y_values)
```

Първият вариант е за предпочитане.

Имайте предвид, че за численото решение е съществено, че началото на интервала и $x_0$ от началното условие в задачата на Коши съвпадат. Ако не съвпадат, то трябва да се разбие интервала на 2 части - до $x_0$ и след него.

### Допълнителни

Можете да използвате следните функционалности за да украсите получената графика.

```matlab
hold on
grid on

axis([x_min x_max y_min y_max])
xlabel('x')
ylabel('y')
title('Solution')
```

Също можете да използвате допълнителни аргументи на `plot`, с които да промените цвета на графика, дебелината на линиите и други. Всичко може да се намери в официалната документация.

### Кликане с мишката

Ако е необходимо графиката на решението да минава през точка, кликната с мишката, то ето как можем да модифицираме кода за да изпълнява това условие.

```matlab
hold on;
axis([0, 5, 1, 8])  % x in [0, 5] and y in [1, 8]

syms x y(x)

ode = diff(y, x) == (2 / y) * (x+1)^2

[x_0, y_0] = ginput(1);
plot(x_0, y_0, "r*")  % изобразява точката (x_0, y_0) с червена звезда

initial_condition = y(x_0) == y_0

symbolic_solution = dsolve(ode, initial_condition)

x_axis = 0:0.25:5;  % равноотдалечени възли от 0 до 5 през 0.25

plot(x_axis, double(subs(symbolic_solution, x, x_axis)))
```
