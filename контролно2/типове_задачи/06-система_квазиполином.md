# Нехомогенни линейни системи със свободен член квазиполином

## Общ вид

$$
\begin{cases}
\dot{x} = k_1x + k_2y + f_1(t) \newline
\dot{y} = k_3x + k_4y + f_2(t)
\end{cases}
$$

$f_1(t), \space f_2(t)$ са квазиполиноми.

$k_1, \space k_2, \space k_3, \space k_4 \in \mathbb{R}$

## Алгоритъм за решаване

На хомогенната система съпоставяме матрицата A:

$$
A = 
\begin{pmatrix}
k_1 & k_2 \newline
k_3 & k_4
\end{pmatrix}
$$

На матрицата $A$ съответства следният характеристичен полином:

$$P_A(\lambda) = \det(A - \lambda E)$$

$$P_A(\lambda) =
\left[
    \begin{array}{}
        k_1 - \lambda & k_2           
        \newline
        k_3           & k_4 - \lambda
    \end{array}
\right]
$$

$$P_A(\lambda) = (k_1 - \lambda)(k_4 - \lambda) - k_2 k _3$$

Приравняваме характеристичния полином на $0$.

$$(k_1 - \lambda)(k_4 - \lambda) - k_2 k _3 = 0$$

Решаваме уравнението и получаваме 2 корена $\lambda_1$ и $\lambda_2$.

Определяме ФСР спрямо $\lambda_1$ и $\lambda_2$. (виж определяне–на–ФСР.md)

$$\text{ФСР }=\lbrace \phi_{1}, \space \phi_{2} \rbrace$$

За общото решение на хомогенната система имаме:

$$x_0 = C_1 \phi_1 + C_2 \phi_2$$

$$y_0 = C_3 \phi_1 + C_4 \phi_2$$

За две ОДУ от първи ред ни трябват най-много 2 произволни констнанти, а не 4. Затова ще изразим 2 от тях като линейна комбинация на останалите 2.

Това ще го постигнем като заместим с $x_0, y_0, \dot{x_0}, \dot{y_0}$ в едно от двете уравнения на хомогенната система (тоест игнорираме $f_1$ и $f_2$). Няма значение в кое от двете уравнения от системата заместим, трябва да се получи едно и също.

Нека изразим например $C_3$ и $C_4$ като линейна комбинация на $C_1$ и $C_2$.

Така получаваме:

$$x_0 = C_1 \phi_1 + C_2 \phi_2$$

$$y_0 = (m_1C_1 + m_2C_2) \phi_1 + (n_1C_1 + n_2C_2) \phi_2$$

$m_1, m_2, n_1, n_2$ са някакви константи, вероятнно някои от тях са $0$.

Това са общи решения за хомогенната система, но нека ги запишем в матричен запис. Ще разкрием скобите така, че да изнесем $C_1$ и $C_2$ пред скоби.

$$x_0 = C_1 \phi_1 + C_2 \phi_2$$

$$y_0 = C_1(m_1\phi_1 + n_1\phi_2) + C_2(m_2\phi_1 + n_2\phi_2)$$

Търсим частно решение.

Нека $f_1$ и $f_2$ имат вида:

$$f_1 = P_{k_1}\mathrm{e}^{\alpha t}$$

$$f_2 = R_{k_2}\mathrm{e}^{\alpha t}$$

където $P_{k_1}$ е полином от степен $k_1$ и $R_{k_2}$ е полином от степен $k_2$.

Нека $\alpha$ е $s$-кратен корен на характеристичния полином.

Тогава $x_1$ и $y_1$ ще имат следния вид:

$$Q_{\max\lbrace k_1, k_2\rbrace + s}(t) \mathrm{e}^{\alpha t}$$

Изразяваме $x_1$, $y_1$, $x_1'$ и $y_1'$ и заместваме в нехомогенната система. Така ще получим коефициентите, с които да изразим в явен вид $x_1$ и $y_1$.

Така за общото решение на нехомогенната система имаме:

$$x = x_0 + x_1$$

$$y = y_0 + y_1$$

## Конкретен пример

$$
\begin{cases}
\dot{x} = x + y + \mathrm{e}^{t} \newline
\dot{y} = 4x + y
\end{cases}
$$

На хомогенната система съпоставяме матрицата A:

$$
A = 
\begin{pmatrix}
1 & 1 \newline
4 & 1
\end{pmatrix}
$$

На матрицата $A$ съответства следният характеристичен полином:

$$P_A(\lambda) = \det(A - \lambda E)$$

$$P_A(\lambda) =
\left[
    \begin{array}{}
        1 - \lambda & 1           
        \newline
        4           & 1 - \lambda
    \end{array}
\right]
$$

$$P_A(\lambda) = (1 - \lambda)(1 - \lambda) - 4$$

Приравняваме характеристичния полином на $0$.

$$(1 - \lambda)(1 - \lambda) - 4 = 0$$

$$\lambda^2 - 2\lambda - 3 = 0$$

Получаваме 2 корена $\lambda_1 = -1$ и $\lambda_2 = 3$.

Определяме ФСР спрямо $\lambda_1$ и $\lambda_2$. (виж определяне–на–ФСР.md)

$$\text{ФСР }=\lbrace \mathrm{e}^{-t}, \space \mathrm{e}^{3t} \rbrace$$

За общото решение на хомогенната система имаме:

$$x_0 = C_1 \mathrm{e}^{-t} + C_2 \mathrm{e}^{3t}$$

$$y_0 = C_3 \mathrm{e}^{-t} + C_4 \mathrm{e}^{3t}$$

Ще елиминираме 2 от константите като заместим в първото уравнение от системата с $\dot{x_0}, x_0, y_0$, като игнорираме свободния член. 

$$\dot{x_0} = x_0 + y_0$$

$$(C_1 \mathrm{e}^{-t} + C_2 \mathrm{3e}^{t})' = (C_1 \mathrm{e}^{-t} + C_2 \mathrm{e}^{3t}) + (C_3 \mathrm{e}^{-t} + C_4 \mathrm{e}^{3t})$$

$$-C_1 \mathrm{e}^{-t} + 3C_2 \mathrm{e}^{3t} = C_1 \mathrm{e}^{-t} + C_2 \mathrm{e}^{3t} + C_3 \mathrm{e}^{-t} + C_4 \mathrm{e}^{3t}$$

$$2C_2 \mathrm{e}^{3t} - C_4 \mathrm{e}^{3t} = 2C_1 \mathrm{e}^{-t} + C_3 \mathrm{e}^{-t}$$

$$(2C_2 - C_4) \mathrm{e}^{3t} = (2C_1 + C_3) \mathrm{e}^{-t}$$

$$
\begin{cases}
2C_1+C_3 = 0 \newline
2C_2 - C_4 = 0
\end{cases}
$$

$$
\begin{cases}
C_3 = -2C_1 \newline
C_4 = 2C_2
\end{cases}
$$

Така получаваме:

$$x_0 = C_1 \mathrm{e}^{-t} + C_2 \mathrm{e}^{3t}$$

$$y_0 =  -2C_1 \mathrm{e}^{-t} + 2C_2 \mathrm{e}^{3t}$$

Търсим частно решение.

Нека $f_1$ и $f_2$ имат вида:

$$f_1 = P_{k_1}\mathrm{e}^{\alpha t}$$

$$f_2 = P_{k_2}\mathrm{e}^{\alpha t}$$

където $P_{k_1}$ е полином от степен $k_1$ и $R_{k_2}$ е полином от степен $k_2$.

$$\alpha = 1$$

$$P_{k_1} = 1$$

$$R_{k_2} = 0$$

$$\implies k_1 = 0, \space k_2 = 0$$

Нека $\alpha = 1$ е $0$-кратен корен на характеристичния полином.

Тогава $x_1$ и $y_1$ ще имат следния вид:

$$Q_{\max\lbrace k_1, k_2\rbrace + s}(t) \mathrm{e}^{\alpha t}$$

$$Q_{\max\lbrace 0, 0\rbrace + 0}(t) \mathrm{e}^{\alpha t}$$

$$Q_0(t) \mathrm{e}^{\alpha t}$$

Изразяваме $x_1$, $y_1$, $x_1'$ и $y_1'$ и заместваме в нехомогенната система. Така ще получим коефициентите, с които да изразим в явен вид $x_1$ и $y_1$.

$$x_1 = a\mathrm{e}^{t}$$

$$y_1 = b\mathrm{e}^{t}$$

$$\dot{x_1} = a\mathrm{e}^{t}$$

$$\dot{y_1} = b\mathrm{e}^{t}$$

$$
\begin{cases}
\dot{x_1} = x_1 + y_1 + \mathrm{e}^{t} \newline
\dot{y_1} = 4x_1 + y_1
\end{cases}
$$

$$
\begin{cases}
a\mathrm{e}^{t} = a\mathrm{e}^{t} + b\mathrm{e}^{t} + \mathrm{e}^{t} \newline
b\mathrm{e}^{t} = 4a\mathrm{e}^{t} + b\mathrm{e}^{t}
\end{cases}
$$

$$
\begin{cases}
0 = b + 1 \newline
0 = 4a
\end{cases}
$$

$$(a, b) = (0, -1)$$

$$x_1 = 0$$

$$y_1 = -\mathrm{e}^{t}$$

Така за общото решение на нехомогенната система имаме:

$$x = x_0 + x_1$$

$$y = y_0 + y_1$$

$$x = C_1 \mathrm{e}^{-t} + C_2 \mathrm{e}^{3t}$$

$$y = -2C_1 \mathrm{e}^{-t} + 2C_2 \mathrm{e}^{3t} - \mathrm{e}^{t}$$